<!--<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  
<link rel="stylesheet" href="./css/bootstrap.css" type="text/css">
<link rel="stylesheet" href="./css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="./css/ui.totop.css" type="text/css">
<link rel="stylesheet" href="./css/application.css" type="text/css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="http://code.responsivevoice.org/responsivevoice.js"></script>
	
<script>

	var responsiveVoiceParams = {
		volume: 1,
		rate: 1,
	};
	
	function sayText(text){
		if (responsiveVoice.isPlaying())
			responsiveVoice.cancel();

		var voice = $("#voicesDropdown").val();
		responsiveVoice.speak(text, voice, responsiveVoiceParams);
	}
	
	function addTextToHistory(text){
		var $textHistory = $("#textHistory");
		$textHistory.append($("<li/>").text(text));
		$textHistoryItems = $textHistory.children("li");
		if ($textHistoryItems.size() > 5)
			$textHistoryItems.first().remove();
			
	}
	
	function textboxSubmit(){
		var $textInput = $("#textInput");
		var text = $textInput.val();
		$textInput.val('');
		if (text != ""){
			sayText(text);
			addTextToHistory(text);
		}
	}
	
	$(function(){
		$("#textInput").keypress(function(e){
			if(e.keyCode == 13)
				textboxSubmit();
		});
		
		$("#playButton").click(function(){
			textboxSubmit();
		});
	
// Cant do this- I have to pass in a voice to the speak command or the stupid thing cries		
//		$("#voicesDropdown").change(function(){
//			responsiveVoice.setDefaultVoice($("#voicesDropdown").val());
//		});
			
		var voiceOptions = responsiveVoice.getVoices();
		var $voicesDropdown = $("#voicesDropdown");
		for(var i = 0; i < voiceOptions.length; ++i){
			var voice = voiceOptions[i].name;
			$voicesDropdown.append($("<option />").val(voice).text(voice));
		}
	});
</script>
	
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<title>Speak Easy</title>
</head>
	
<body>
	<div class="main">
	
		<header>
			<div id="masthead" class="container">
				<h2 id="theme-title">Speak Easy</h2>
			</div>
		</header>

		<div id="content" class="container">
			
			<div class="section col-md-4">
				<select id="voicesDropdown" name="voicesDropdown" class="form-control"></select>
				<br /><br />
				<ul id="textHistory"></ul>
				<br /><br />
				<div class="input-group">
					<input id="textInput" name="textInput" type="text" class="form-control" value="Hot Tamales"/>
					<span class="input-group-btn">
						<button id="playButton" name="playButton" type="button" class="btn btn-success">Play</button>
					</span>
				</div>
			</div>
			
			<div class="col-md-8">
			</div>
		</div>
	
	</div>
</body>
	
</html>